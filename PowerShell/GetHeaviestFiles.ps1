$logFile="$env:TEMP\FileScanLog.txt"; Write-Host "Starting scan at $(Get-Date)" -ForegroundColor Cyan; "Starting scan at $(Get-Date)" | Out-File $logFile; $counter=0; Get-ChildItem -Path C:\ -Recurse -File -ErrorAction SilentlyContinue | ForEach-Object { $counter++; if($counter % 1000 -eq 0){$msg="Scanned $counter files. Current: $($_.Directory)"; Write-Host $msg -ForegroundColor Gray; $msg | Out-File $logFile -Append} $_ } | Sort-Object Length -Descending | Select-Object -First 200 FullName, @{N="SizeGB";E={[math]::Round($_.Length/1GB,2)}} | ForEach-Object { $msg="Top file: $($_.FullName) ($($_.SizeGB)GB)"; Write-Host $msg -ForegroundColor Yellow; $msg | Out-File $logFile -Append; $_ }; $endMsg="Scan completed at $(Get-Date). Total: $counter files"; Write-Host $endMsg -ForegroundColor Cyan; $endMsg | Out-File $logFile -Append; Write-Host "Log saved to: $logFile" -ForegroundColor Green