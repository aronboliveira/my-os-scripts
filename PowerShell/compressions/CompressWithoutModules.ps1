$sourceDir = Get-Location; $zipDestination = "$($sourceDir.Path).zip"; $excludeDirs = @('node_modules', 'vendor'); Compress-Archive -Path (Get-ChildItem -Path $sourceDir -Recurse -File | Where-Object { -not ($excludeDirs | Where-Object { $_.FullName -like "*\$dir*" }) }).FullName -DestinationPath $zipDestination -Force
