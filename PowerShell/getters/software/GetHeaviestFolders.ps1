$folderSizes=@{};$counter=0;Get-ChildItem -Path C:\ -Recurse -File -ErrorAction SilentlyContinue | ForEach-Object { $currentFolder=$_.Directory; while($currentFolder){ if($folderSizes[$currentFolder.FullName]){$folderSizes[$currentFolder.FullName]+=$_.Length}else{$folderSizes[$currentFolder.FullName]=$_.Length} $currentFolder=$currentFolder.Parent}; $counter++; if($counter % 1000 -eq 0){Write-Host "Scanned $counter files... Current location: $($_.Directory)" -ForegroundColor Cyan}}; Write-Host "`nCOMPLETE: Processed $totalCount files total.`n" -ForegroundColor Green; $folderSizes.GetEnumerator() | Sort-Object Value -Descending | Select-Object -First 200 | ForEach-Object { [PSCustomObject]@{ FolderPath=$_.Key; TotalSizeGB=[math]::Round($_.Value/1GB,2); TotalSizeMB=[math]::Round($_.Value/1MB,2); FileCount=(Get-ChildItem $_.Key -File -Recurse -ErrorAction SilentlyContinue).Count } } | Format-Table -AutoSize