Write "Searching for PHP... üêò"; $result = (gci . -Recurse -File -Filter "*.php" | % { try { $oc = [Console]::ForegroundColor; [Console]::ForegroundColor = 'Gray'; [Console]::WriteLine("Found $($_.FullName)..."); [Console]::ForegroundColor = $oc; (cat $_.FullName -EA Stop).Count } catch { Write-Warning "Could not read file $($_.FullName)"; 0 } }) | measure -Sum; [PSCustomObject]@{'Total of PHP Files' = $result.Count; 'Total of PHP Lines' = $result.Sum}